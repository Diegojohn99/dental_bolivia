<div class="min-h-screen bg-dental-light py-8 px-4 flex items-center justify-center">
  <div class="bg-white shadow-lg rounded-2xl max-w-2xl w-full p-5 md:p-8 space-y-6">
    <div class="text-center space-y-1">
      <p class="text-[11px] uppercase tracking-[0.2em] text-dental-accent">Dental Bolivia</p>
      <h1 class="text-2xl font-semibold text-dental-primary">Agenda tu cita</h1>
      <p class="text-xs text-gray-500">Proceso rápido en 2 pasos. Tus datos estarán protegidos.</p>
    </div>

    <%= form_with scope: :booking, url: public_booking_path, class: "space-y-5" do |f| %>
      <!-- Paso 1: Datos del paciente -->
      <div class="space-y-3">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-1">
          <h2 class="text-sm md:text-base font-semibold text-gray-700 flex items-center space-x-2">
            <span class="w-6 h-6 rounded-full bg-dental-primary text-white text-xs flex items-center justify-center">1</span>
            <span>Tus datos</span>
          </h2>
          <span class="text-[11px] text-gray-400 md:text-xs">Obligatorio</span>
        </div>

        <div class="space-y-2">
          <div>
            <%= f.label :patient_name, "Nombre completo", class: "block text-xs font-medium text-gray-700" %>
            <%= f.text_field :patient_name,
                             name: "booking[patient][name]",
                             class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary",
                             placeholder: "Ej. María Pérez" %>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <%= f.label :patient_email, "Correo electrónico", class: "block text-xs font-medium text-gray-700" %>
              <%= f.email_field :patient_email,
                                name: "booking[patient][email]",
                                class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary",
                                placeholder: "tu@correo.com" %>
            </div>
            <div>
              <%= f.label :patient_phone, "Teléfono", class: "block text-xs font-medium text-gray-700" %>
              <%= f.telephone_field :patient_phone,
                                     name: "booking[patient][phone]",
                                     class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary",
                                     placeholder: "+591..." %>
            </div>
          </div>
        </div>
      </div>

      <!-- Paso 2: Detalles de la cita -->
      <div class="space-y-3">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-1">
          <h2 class="text-sm md:text-base font-semibold text-gray-700 flex items-center space-x-2">
            <span class="w-6 h-6 rounded-full bg-dental-secondary text-white text-xs flex items-center justify-center">2</span>
            <span>Detalles de la cita</span>
          </h2>
          <span class="text-[11px] text-gray-400 md:text-xs">Elige servicio y horario</span>
        </div>

        <div class="space-y-2">
          <div>
            <%= f.label :service_type, "Servicio", class: "block text-xs font-medium text-gray-700" %>
            <%= f.text_field :service_type,
                             name: "booking[appointment][service_type]",
                             placeholder: "Limpieza, control, ortodoncia...",
                             class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary" %>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <%= f.label :dentist_id, "Dentista", class: "block text-xs font-medium text-gray-700" %>
              <%= select_tag "booking[appointment][dentist_id]",
                            options_from_collection_for_select(@dentists, :id, :name),
                            prompt: "Cualquiera",
                            class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary" %>
            </div>
            <div>
              <%= f.label :scheduled_at, "Fecha y hora", class: "block text-xs font-medium text-gray-700" %>
              <%= datetime_field_tag "booking[appointment][scheduled_at]", nil,
                                     class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary" %>
            </div>
          </div>

          <div>
            <%= f.label :notes, "Comentarios (opcional)", class: "block text-xs font-medium text-gray-700" %>
            <%= text_area_tag "booking[appointment][notes]", nil,
                               rows: 3,
                               class: "mt-1 block w-full border-gray-300 rounded-lg text-sm px-3 py-2 focus:ring-dental-primary focus:border-dental-primary",
                               placeholder: "Indica si tienes alguna condición o preferencia." %>
          </div>
        </div>
      </div>

      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="flex items-start">
          <%= f.check_box :privacy_consent, 
                          required: true,
                          class: "mt-1 h-4 w-4 text-dental-primary border-gray-300 rounded focus:ring-dental-primary" %>
          <%= f.label :privacy_consent, class: "ml-2 text-sm text-blue-800" do %>
            <strong>Acepto el tratamiento de mis datos personales</strong> conforme a la 
            <%= link_to "política de privacidad", privacy_policy_path, target: "_blank", class: "underline hover:text-blue-600" %> 
            de la clínica para fines de atención médica, programación de citas, facturación y comunicaciones relacionadas con mi tratamiento.
          <% end %>
        </div>
        <div class="mt-2 text-xs text-blue-700">
          <p><strong>Tus derechos:</strong> Puedes acceder, rectificar o solicitar la eliminación de tus datos en cualquier momento.</p>
          <p><strong>Retención:</strong> Conservaremos tu historial médico por 10 años según normativa sanitaria.</p>
        </div>
      </div>

      <div class="pt-1 flex flex-col space-y-2">
        <%= f.submit "Confirmar cita", class: "w-full py-2.5 bg-dental-primary text-white rounded-lg text-sm font-semibold shadow-sm hover:bg-sky-600" %>
        <p class="text-[11px] text-center text-gray-400">Recibirás un correo con el resumen y enlaces para confirmar o cancelar.</p>
      </div>
    <% end %>
  </div>
</div>
